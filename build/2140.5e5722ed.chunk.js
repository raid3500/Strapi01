"use strict";(self.webpackChunkproject_6_v_4_20_2=self.webpackChunkproject_6_v_4_20_2||[]).push([[2140],{22140:(O,g,a)=>{a.r(g),a.d(g,{default:()=>B});var e=a(59701),l=a(21272),c=a(7537),K=a(42455),P=a(55356),k=a(4198),A=a(94061),D=a(43739),L=a(95336),y=a(85963),u=a(63891),b=a(30893),E=a(20636);const f=u.default.div`
  margin-top: 35px;

  & > div {
    margin-bottom: 15px;
  }
`,w=u.default.div`
  display: flex;
  margin-top: 15px;

  button {
    margin-right: 0.8rem;
  }
`,m=(0,u.default)(b.o)`
  margin-top: 15px;
`,x=(0,u.default)(E.F)`
  margin-bottom: 30px;
`;var h=a(38283);const j={apiKey:"",apiSecret:"",dc:"",listID:"",formId:""},F=()=>{const[i,C]=l.useState(),[s,n]=l.useState(j),[p,S]=l.useState({}),[I,o]=l.useState(!1),[N,d]=l.useState(!1),R=["mailchimp","convertkit"],v={mailchimp:{name:"Mailchimp",validator:()=>!(!s.apiKey||!s.dc||!s.listID),checkConnection:async()=>{try{await(0,h.tL)(),d(!1),o("Connection Successful")}catch{d(!0),o(null)}},renderView:()=>(0,e.jsxs)(f,{children:[(0,e.jsx)("div",{children:(0,e.jsx)(c.k,{placeholder:"API Key",label:"API Key",required:!0,onChange:t=>n(r=>({...r,apiKey:t.target.value})),value:s.apiKey,type:"password"})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.k,{placeholder:"DC",label:"DC",required:!0,onChange:t=>n(r=>({...r,dc:t.target.value})),value:s.dc})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.k,{placeholder:"List ID",label:"List ID",required:!0,onChange:t=>n(r=>({...r,listID:t.target.value})),value:s.listID})}),(0,e.jsxs)(m,{as:"h3",children:["Read"," ",(0,e.jsx)("a",{href:"https://mailchimp.com/en-gb/help/find-audience-id/",target:"_blank",children:"here"})," ","to learn how to get the list ID from mailchimp."]})]})},convertkit:{name:"Convert Kit",validator:()=>!(!s.apiKey||!s.apiSecret||!s.formId),checkConnection:async()=>{try{await(0,h.W5)(),d(!1),o("Connection Successful")}catch{d(!0),o(null)}},renderView:()=>(0,e.jsxs)(f,{children:[(0,e.jsx)("div",{children:(0,e.jsx)(c.k,{placeholder:"API Key",label:"API Key",required:!0,onChange:t=>n(r=>({...r,apiKey:t.target.value})),value:s.apiKey})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.k,{placeholder:"API Secret",label:"API Secret",required:!0,onChange:t=>n(r=>({...r,apiSecret:t.target.value})),value:s.apiSecret,type:"password"})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.k,{placeholder:"Form ID",label:"Form ID",required:!0,onChange:t=>n(r=>({...r,formId:t.target.value})),value:s.formId})})]})}};l.useEffect(()=>{T()},[]);const T=async()=>{const{data:{provider:t,...r}}=await(0,h.mt)();S(r),n(r),C(t)},M=async()=>{const{data:t}=await(0,h.oc)({...s,provider:i});try{S(t),o("Settings saved successfully")}catch{d(!0),o(null)}};return(0,e.jsxs)(K.P,{children:[(0,e.jsx)(P.$,{title:"Strapi Newsletter",subtitle:"Setup Your Newsletter Provider"}),(0,e.jsxs)(k.s,{children:[I&&(0,e.jsx)(x,{closeLabel:"Close alert",title:"Success",variant:"success",onClose:()=>{o(null)},children:I}),N&&(0,e.jsx)(x,{closeLabel:"Close alert",title:"Error",variant:"danger",onClose:()=>{d(!1)},children:"Error occurred, Please check your settings"}),(0,e.jsxs)(A.a,{padding:8,shadow:"tableShadow",background:"neutral0",hasRadius:!0,children:[(0,e.jsx)(D.l,{label:"Email Newsletter Provider",value:i,onChange:t=>{t!=i?n(j):n(p),C(t)},children:R.map(t=>(0,e.jsx)(L.c,{value:t,children:v[t].name},t))}),(0,e.jsx)("div",{children:i&&v[i].renderView()}),(0,e.jsx)(m,{as:"h3",children:"Configure A Newsletter Provider and Click On Check Connection Button After Saving Your Settings To Check If Your API Keys are Working."}),(0,e.jsxs)(w,{children:[(0,e.jsx)(y.$,{onClick:async()=>{v[i].validator()&&await M()},children:"Save Keys"}),(0,e.jsx)(y.$,{variant:"tertiary",disabled:Object.entries(p).length==0||s.apiKey!==p.apiKey,onClick:()=>{v[i].checkConnection()},children:"Check Connection"})]})]})]})]})},B=(0,l.memo)(F)}}]);
